# Лабораторная работа 4
## Задание
1. Изучите, идентифицируйте и дайте пример использования контекста с динамическими свойствами, 
   определенный в библиотеке, для передачи данных, неизвестных библиотеке.

   Например, система аутентификации в ASP.NET Core (`AuthenticationProperties.Items`),
   `ActionFilter` в MVC (`ActionExecutingContext.ActionParameters`),
   middleware (`HttpContext.Items`),
   FluentValidation (`ValidationContext.RootContextData`),
   HotChocolate (`IResolverContext.ContextData`),
   WPF (Behaviors), etc.

2. Объясните, почему подход `FatStruct` не пойдет, если проект, определяющий его,
   является библиотекой, не знающей о своих пользователях.
   
3. Достигните возможности одного проекта работать с сущностями, определенными в другом проекте.
   Используйте один из динамических подходов (`object[]` или словарь).
   Сделайте возможным проекту, потребляющему библиотеку, задавать как части сущностей,
   так и операции, которые будут выполняться с ними на основе этих данных.

   Другими словами, создайте систему с контекстом, как в библиотеках в 1-м пункте,
   но сами. Изолируйте ее от потребительского проекта.
   
4. Сделайте централизованный реестр ключей, чтобы 2 проекта, потребляющих 
   тот же контекст или базовый тип сущности из библиотеки,
   не смогли записать разные несовместимые данные по тому же ключу.
   
   Используйте или `int` в обертке как ключ, или давайте пользователю пытаться добавить свой ключ
   в глобальный реестр библиотеки, и давайте ошибку, если такой уже был добавлен.

   Используйте паттерн типизированного ключа, используя генерик.

5. Задокументируйте, что вы изучили и ваш ход мыслей при выполнении разных подходов, в markdown документе.


## Решение 
1. Что такое контекст с динамическими свойствами - контекст с динамическими свойствами — это объект, который существует во время выполнения (runtime) и позволяет добавлять, изменять и передавать данные, заранее не известные библиотеке или фреймворку.
Такой контекст часто используется:  
для расширения поведения без изменения исходного кода библиотеки;  
для передачи данных между слоями (middleware, фильтрами, обработчиками и т.д.);  
для временного хранения состояния в рамках одного запроса, транзакции или операции.  

2. Что такое FatStruct (жирная структура)
FatStruct — это подход, при котором все возможные данные, которые могут понадобиться где-либо в проекте, заранее закладываются в один большой объект (структуру или класс).
Вместо того чтобы позволять пользователям добавлять данные динамически, мы проектируем «жирный» объект с кучей полей под всё подряд.
Проблема: библиотека не знает, что нужно пользователю
Если проект — это библиотека, то она не может заранее знать, какие данные пользователи захотят туда передавать. Главный изъян FatStruct:
он требует знания всех возможных свойств заранее, то есть жёсткого контракта на структуру данных.
